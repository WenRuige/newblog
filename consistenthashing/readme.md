#### 一致性哈希


> 为什么要用一致性哈希?

假设我们有一组缓存服务器,为了将图片相对均匀的存储在三台缓存服务器上,我们可能会对服务器进行取模
hash(图片地址) % 服务器数量,这样就会有一个弊端,当某一台服务器挂掉了,无法进行缓存,那么对于挂掉的机器之前的请求流量,可能会打到其他两台机器上,由于大量缓存同一时间失效,可能会导致缓存雪崩问题出现


##### 一致性哈希实现方式

一致性哈希也是使用取模的方式,普通的哈希方式可能是对服务器数量进行取模,但是一致性哈希是对2^32进行取模




假设我们有三台服务器,那么对应的地址为:

* hash(服务器A地址) % 2^32
* hash(服务器B地址) % 2^32
* hash(服务器C地址) % 2^32


假设我们需要缓存的数据为图片,那么我们可以用如下方式将哈希映射到环上
```
hash(图片名称) % 2^32
hash(图片名称1) % 2^32
....(依次类推)
```


那么这张图片应该映射到哪一台服务器上呢?

上图图片会缓存到服务器A上,




##### 哈希环的偏斜





##### 虚拟节点








参考资料:
[一致性哈希参考](http://www.zsythink.net/archives/1182/)